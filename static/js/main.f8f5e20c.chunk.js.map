{"version":3,"sources":["state/index.js","state/actions.js","components/HabitList.js","panels/Home.js","hooks/useLocalStorage.js","panels/Startup.js","panels/Preloader.js","hooks/useApi.js","panels/Habit.js","components/InfoSnackbar.js","App.js","index.js"],"names":["initialState","view","panel","history","activeModal","habits","error","popout","reducer","state","action","type","payload","backElement","length","newHistory","pop","modal","habitId","index","findIndex","item","_id","habit","State","createContext","StateProvider","children","value","useReducer","Provider","HabitList","useContext","dispatch","map","key","header","title","data-id","onClick","subheader","status","daysComplete","days","style","marginTop","mode","asideMode","Home","id","useState","contextOpened","setContextOpened","bridge","subscribe","detail","data","console","log","aside","transform","opened","onClose","weight","before","send","paddingBottom","vertical","className","initialValue","localStorage","getItem","setValue","setLocalStorageValue","setItem","templates","icon","buttonText","placeholderText","placeholder","Startup","useLocalStorage","setDone","dispatchStartup","Preloader","doneStartup","useEffect","done","JSON","parse","url","isLoading","setLoading","response","setResponse","setError","options","setOptions","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","headers","queryString","window","location","search","a","axios","then","catch","fetchData","HabitPage","setHabit","useApi","needFetch","setNeedFetch","left","size","InfoSnackbar","snackbar","setSnackbar","color","message","osName","platform","App","setTitle","setDays","find","modalBack","dynamicContentHeight","IOS","right","onSubmit","e","preventDefault","required","onChange","currentTarget","top","min","max","step","d","alignY","alignX","activeView","activePanel","Habit","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.f8f5e20c.chunk.js","sourcesContent":["import {\r\n\tSET_VIEW,\r\n\tSET_PANEL,\r\n\tSET_MODAL,\r\n\tSET_HABITS,\r\n\tSET_ERROR,\r\n\tSET_HISTORY_BACK,\r\n\tSET_HABIT_ID, SET_CHANGE_HABIT, SET_POPOUT\r\n} from \"./actions\";\r\nimport React, {createContext, useReducer} from 'react';\r\n\r\nconst initialState = {\r\n\tview: 'preloader',\r\n\tpanel: 'preloader',\r\n\thistory: [],\r\n\tactiveModal: null,\r\n\thabits: [],\r\n\terror: null,\r\n\tpopout: null\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_VIEW:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tview: action.payload.view,\r\n\t\t\t\tpanel: action.payload.panel,\r\n\t\t\t\thistory: [...state.history, {view: action.payload.view, panel: action.payload.panel}]\r\n\t\t\t}\r\n\t\tcase SET_PANEL:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpanel: action.payload.panel,\r\n\t\t\t\thistory: [...state.history, {view: state.view, panel: action.payload.panel}]\r\n\t\t\t}\r\n\t\tcase SET_HISTORY_BACK:\r\n\t\t\tconst backElement = state.history[state.history.length-2];\r\n\t\t\tif (!backElement) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tview: 'home',\r\n\t\t\t\t\tpanel: 'home',\r\n\t\t\t\t\thistory: [{view: 'home', panel: 'home'}]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst newHistory = state.history;\r\n\t\t\tnewHistory.pop();\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thistory: [...newHistory],\r\n\t\t\t\tview: backElement.view,\r\n\t\t\t\tpanel: backElement.panel\r\n\t\t\t}\r\n\t\tcase SET_MODAL:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tactiveModal: action.payload.modal\r\n\t\t\t}\r\n\t\tcase SET_HABITS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabits: action.payload.habits\r\n\t\t\t}\r\n\t\tcase SET_HABIT_ID:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabitId: action.payload.habitId\r\n\t\t\t}\r\n\t\tcase SET_CHANGE_HABIT:\r\n\t\t\tconst habits = state.habits;\r\n\t\t\tconst index = habits.findIndex(item => {\r\n\t\t\t\treturn item._id === action.payload.habit._id\r\n\t\t\t});\r\n\t\t\thabits[index] = action.payload.habit;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabits: [...habits]\r\n\t\t\t}\r\n\t\tcase SET_ERROR:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\tcase SET_POPOUT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","export const SET_VIEW = 'SET_VIEW';\r\nexport const SET_PANEL = 'SET_PANEL';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_HABITS = 'SET_HABITS';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_HISTORY_BACK = 'SET_HISTORY_BACK';\r\nexport const SET_HABIT_ID = 'SET_HABIT_ID';\r\nexport const SET_CHANGE_HABIT = 'SET_CHANGE_HABIT';\r\nexport const SET_POPOUT = 'SET_POPOUT';","import React, { useContext } from 'react';\r\nimport {Banner, InfoRow, Progress} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_HABIT_ID, SET_VIEW} from \"../state/actions\";\r\n\r\nconst HabitList = ({habits}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\treturn habits.map((habit) => {\r\n\t\treturn (\r\n\t\t\t<Banner\r\n\t\t\t\tkey={habit._id}\r\n\t\t\t\theader={habit.title}\r\n\t\t\t\tdata-id={habit._id}\r\n\t\t\t\tonClick={() => {\r\n\t\t\t\t\tdispatch({type: SET_VIEW, payload: { view: 'habit-page', panel: 'habit-page'}});\r\n\t\t\t\t\tdispatch({type: SET_HABIT_ID, payload: { habitId: habit._id}});\r\n\t\t\t\t}}\r\n\t\t\t\tsubheader={\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<InfoRow header={\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<p>Статус: <strong>{habit.status === 'active' ? 'Активно' : 'Выполнено'}</strong></p>\r\n\t\t\t\t\t\t\t\t<p>Дней подряд: <strong>{habit.daysComplete}</strong> / <strong>{habit.days}</strong></p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t}>\r\n\t\t\t\t\t\t\t<Progress value={(habit.daysComplete/habit.days)*100}  style={{marginTop: '1em'}}/>\r\n\t\t\t\t\t\t</InfoRow>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\tmode={'tint'}\r\n\t\t\t\tasideMode={'expand'}\r\n\t\t\t/>\r\n\t\t)\r\n\t})\r\n}\r\n\r\nexport default HabitList;\r\n","import React, {useContext, useState} from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport {\n\tCell,\n\tCellButton, Div,\n\tFixedLayout,\n\tFormLayout,\n\tGroup, Headline,\n\tList,\n\tPanelHeaderContent,\n\tPanelHeaderContext, Text\n} from \"@vkontakte/vkui\";\nimport Icon24Add from '@vkontakte/icons/dist/24/add';\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\nimport Icon28ShareExternalOutline from '@vkontakte/icons/dist/28/share_external_outline';\nimport {State} from \"../state\";\nimport {SET_MODAL} from \"../state/actions\";\nimport HabitList from \"../components/HabitList\";\n\nimport './style.css';\n\nconst Home = ({ id, habits }) => {\n\tconst [, dispatch] = useContext(State);\n\tconst [contextOpened, setContextOpened] = useState(false);\n\n\tbridge.subscribe(({detail: {type, data}}) => {\n\t\tif (type === 'VKWebAppShareResult') {\n\t\t\tconsole.log('Успешно', data);\n\t\t}\n\t});\n\n\treturn (\n\t\t<Panel id={id}  >\n\t\t\t<PanelHeader>\n\t\t\t\t<PanelHeaderContent\n\t\t\t\t\taside={<Icon16Dropdown style={{ transform: `rotate(${contextOpened ? '180deg' : '0'})` }} />}\n\t\t\t\t\tonClick={() => {setContextOpened(!contextOpened)}}\n\t\t\t\t>\n\t\t\t\t\tHabit\n\t\t\t\t</PanelHeaderContent>\n\t\t\t</PanelHeader>\n\t\t\t<PanelHeaderContext opened={contextOpened} onClose={() => {setContextOpened(!contextOpened)}}>\n\t\t\t\t<List>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Headline weight={'semibold'}>О приложении</Headline>\n\t\t\t\t\t\t<Text>Habit - Ваш личный помошник в формировании привычек. Приложение помогает развить хорошие привычки и избавиться от плохих.</Text>\n\t\t\t\t\t</Div>\n\t\t\t\t\t<Cell\n\t\t\t\t\t\tbefore={<Icon28ShareExternalOutline />}\n\t\t\t\t\t\tonClick={() => { bridge.send('VKWebAppShare', {'link': 'https://vk.com/app7564973'})}}\n\t\t\t\t\t>\n\t\t\t\t\t\tПоделиться приложением\n\t\t\t\t\t</Cell>\n\t\t\t\t</List>\n\t\t\t</PanelHeaderContext>\n\t\t\t<Group style={{paddingBottom: '60px'}} >\n\t\t\t\t<HabitList habits={habits} />\n\t\t\t</Group>\n\t\t\t<FixedLayout\n\t\t\t\tvertical={'bottom'}\n\t\t\t\tclassName={'fixed-button'}\n\t\t\t>\n\t\t\t\t<FormLayout>\n\t\t\t\t\t<CellButton\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-habit'}})\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tbefore={<Icon24Add/>}\n\t\t\t\t\t>\n\t\t\t\t\t\tСоздать цель\n\t\t\t\t\t</CellButton>\n\t\t\t\t</FormLayout>\n\t\t\t</FixedLayout>\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Home;\n","import { useState } from 'react';\r\n\r\nexport default (key, initialValue = '') => {\r\n\tconst [value, setValue] = useState(() => {\r\n\t\treturn localStorage.getItem(key) || initialValue;\r\n\t});\r\n\r\n\tconst setLocalStorageValue = (value) => {\r\n\t\tsetValue(value);\r\n\t\tlocalStorage.setItem(key, value)\r\n\t}\r\n\r\n\treturn [value, setLocalStorageValue];\r\n}","import React, {useContext, useReducer} from 'react';\r\nimport {Button, Div, Panel, PanelHeader, Placeholder} from \"@vkontakte/vkui\";\r\nimport Icon56EventOutline from '@vkontakte/icons/dist/56/event_outline';\r\nimport {State} from \"../state\";\r\nimport {SET_VIEW} from \"../state/actions\";\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\n\r\nconst templates = [\r\n\t{\r\n\t\tid: 1,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Формирование привычки',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'В психологии давно установлен факт, что 21 дня достаточно, чтобы привить новые привычки (избавиться от старых) и таким образом улучшить качество жизни',\r\n\t},\r\n\t{\r\n\t\tid: 2,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Поставьте цель и идите к ней',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'Создайте в приложении цель (привычку, которую хотите изменить) и отмечайте ее успешное ежедневное выполнение',\r\n\t},\r\n\t{\r\n\t\tid: 3,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'В формировании привычки важна регулярность',\r\n\t\tbuttonText: 'Начать',\r\n\t\tplaceholderText: 'В случае пропуска ежедневной отметки прогресс сбрасывается, но вы можете запустить счетчик сначала',\r\n\t},\r\n]\r\n\r\nconst initialState = {\r\n\tplaceholder: {\r\n\t\tid: 1,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Формирование привычки',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'В психологии давно установлен факт, что 21 дня достаточно, чтобы привить новые привычки (избавиться от старых) и таким образом улучшить качество жизни',\r\n\r\n\t}\r\n}\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'SET_PLACEHOLDER':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tplaceholder: action.payload.placeholder\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\nconst Startup = ({id}) => {\r\n\tconst [, setDone] = useLocalStorage('startup-done');\r\n\tconst [{placeholder}, dispatchStartup] = useReducer(reducer, initialState);\r\n\tconst [, dispatch] = useContext(State);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>Введение</PanelHeader>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={placeholder.icon}\r\n\t\t\t\theader={placeholder.header}\r\n\t\t\t\taction={\r\n\t\t\t\t\t[<Div key={'action'}>\r\n\t\t\t\t\t\t<Button onClick={\r\n\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\tif (placeholder.id < 3) {\r\n\t\t\t\t\t\t\t\t\tdispatchStartup({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'SET_PLACEHOLDER', payload: {\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: templates[placeholder.id],\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t\t\t\tsetDone('true');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{placeholder.buttonText}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Div>,\r\n\t\t\t\t\t<Div key={'skip'}>\r\n\t\t\t\t\t\t{placeholder.id !== 3 && <Button\r\n\t\t\t\t\t\t\tmode={'tertiary'}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t\t\tsetDone('true');\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПропустить\r\n\t\t\t\t\t\t</Button>}\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{placeholder.placeholderText}\r\n\t\t\t</Placeholder>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default Startup;\r\n","import React, {useEffect, useContext} from 'react';\r\nimport {Panel} from \"@vkontakte/vkui\";\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\nimport {State} from \"../state\";\r\nimport {SET_VIEW} from \"../state/actions\";\r\n\r\nconst Preloader = ({id}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\tconst [doneStartup] = useLocalStorage('startup-done');\r\n\tuseEffect(() => {\r\n\t\tif (!doneStartup) {\r\n\t\t\tdispatch({type: SET_VIEW, payload: {view: 'startup', panel: 'startup'}});\r\n\t\t} else {\r\n\t\t\tconst done = JSON.parse(doneStartup);\r\n\t\t\tif (done) {\r\n\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t} else {\r\n\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'startup', panel: 'startup'}});\r\n\t\t\t}\r\n\t\t}\r\n\t}, [dispatch, doneStartup]);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<div>Habit</div>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default Preloader;\r\n","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_POPOUT} from \"../state/actions\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = `http://localhost/api`;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}})\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search)} : {...queryString.parse(window.location.search)},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\r\n\t\tif (!isLoading) return;\r\n\r\n\t\tconst fetchData = async () => {\r\n\t\t\tawait axios(axiosOptions)\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t\t\tsetResponse(response.data.data);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: error.response.data.error}});\r\n\t\t\t\t\tsetError(error.response.data.error);\r\n\t\t\t\t})\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Button, Panel, PanelHeader, PanelHeaderBack, Placeholder} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport useApi from \"../hooks/useApi\";\r\nimport {SET_CHANGE_HABIT, SET_HABIT_ID, SET_HISTORY_BACK} from \"../state/actions\";\r\n\r\nconst HabitPage = ({id, habit, setHabit}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\tconst [{response}, doApiFetch] = useApi(`/habit/${habit._id}`);\r\n\r\n\tconst [needFetch, setNeedFetch] = useState(false);\r\n\t// const [longPress, setLongPress] = useState(false);\r\n\t// const [pressTimer, setPressTimer] = useState(null);\r\n\t//\r\n\t// const pressStart = () => {\r\n\t// \tif (pressTimer === null) {\r\n\t// \t\tsetPressTimer(setTimeout(() => {\r\n\t// \t\t\tsetLongPress(true);\r\n\t// \t\t}, 1000));\r\n\t// \t}\r\n\t// }\r\n\t// const pressCancel = () => {\r\n\t// \tif (pressTimer !== null) {\r\n\t// \t\tclearTimeout(pressTimer);\r\n\t// \t}\r\n\t// \tsetPressTimer(null);\r\n\t// \tsetLongPress(false);\r\n\t// }\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'PUT'\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [needFetch, doApiFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tsetHabit(response);\r\n\t}, [response, setHabit]);\r\n\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<PanelHeaderBack\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t\tdispatch({type: SET_HABIT_ID, payload: {habitId: null}});\r\n\t\t\t\t\t\tdispatch({type: SET_CHANGE_HABIT, payload: {habit: habit}});\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{habit.title}\r\n\t\t\t</PanelHeader>\r\n\t\t\t<Placeholder\r\n\t\t\t\theader={habit.title}\r\n\t\t\t\taction={\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tsize=\"l\"\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetNeedFetch(true);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tВыполнить на сегодня\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\tДней подряд: {habit.daysComplete} / {habit.days}\r\n\t\t\t</Placeholder>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default HabitPage;\r\n","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\n\r\nconst InfoSnackbar = ({children}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{children}\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;\r\n","import React, {useContext, useEffect, useState} from 'react';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\n\r\nimport Home from './panels/Home';\r\nimport {State} from \"./state\";\r\nimport {\r\n\tCellButton,\r\n\tFormLayout,\r\n\tInput,\r\n\tIOS,\r\n\tModalPage,\r\n\tModalPageHeader,\r\n\tModalRoot,\r\n\tPanelHeaderButton,\r\n\tplatform, PopoutWrapper,\r\n\tRoot,\r\n\tSlider\r\n} from \"@vkontakte/vkui\";\r\nimport Startup from \"./panels/Startup\";\r\nimport Preloader from \"./panels/Preloader\";\r\nimport {SET_HABITS, SET_MODAL} from \"./state/actions\";\r\nimport Icon24Cancel from '@vkontakte/icons/dist/24/cancel';\r\nimport Icon24Dismiss from '@vkontakte/icons/dist/24/dismiss';\r\nimport Icon24Add from '@vkontakte/icons/dist/24/add';\r\nimport useApi from \"./hooks/useApi\";\r\nimport HabitPage from \"./panels/Habit\";\r\nimport InfoSnackbar from \"./components/InfoSnackbar\";\r\n\r\nconst osName = platform();\r\n\r\nconst App = () => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [title, setTitle] = useState('');\r\n\tconst [days, setDays] = useState(21);\r\n\tconst [{response, error}, doApiFetch] = useApi('/habit');\r\n\tconst [needFetch, setNeedFetch] = useState(true);\r\n\tconst [habit, setHabit] = useState(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch();\r\n\t\tsetNeedFetch(false);\r\n\t}, [doApiFetch, needFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_HABITS, payload: {habits: response}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!error) return;\r\n\t\tconsole.log(error);\r\n\t}, [error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.habitId) return;\r\n\t\tsetHabit(state.habits.find((item) => {\r\n\t\t\treturn item._id === state.habitId\r\n\t\t}));\r\n\t}, [state.habitId, state.habits])\r\n\r\n\tconst modalBack = () => {\r\n\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t}\r\n\r\n\tconst modal = (\r\n\t\t<ModalRoot\r\n\t\t\tactiveModal={state.activeModal}\r\n\t\t\tonClose={modalBack}\r\n\t\t>\r\n\t\t\t<ModalPage\r\n\t\t\t\tid={'add-habit'}\r\n\t\t\t\tonClose={modalBack}\r\n\t\t\t\tdynamicContentHeight\r\n\t\t\t\theader={\r\n\t\t\t\t\t<ModalPageHeader\r\n\t\t\t\t\t\tleft={osName !== IOS && <PanelHeaderButton onClick={modalBack}><Icon24Cancel/></PanelHeaderButton>}\r\n\t\t\t\t\t\tright={osName === IOS &&\r\n\t\t\t\t\t\t<PanelHeaderButton onClick={modalBack}>{osName === IOS ? 'Готово' : <Icon24Dismiss/>}</PanelHeaderButton>}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tСоздать цель\r\n\t\t\t\t\t</ModalPageHeader>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<FormLayout\r\n\t\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tdoApiFetch({\r\n\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\tdays: days\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\t\tsetDays(21);\r\n\t\t\t\t\t\tsetTitle('');\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\ttype={'text'}\r\n\t\t\t\t\t\tvalue={title}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetTitle(e.currentTarget.value)\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ttop={'Название цели'}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Slider min={1} max={21} step={1} value={days} top={`Кол-во дней: ${days}`} onChange={(d) => {\r\n\t\t\t\t\t\tsetDays(d)\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<CellButton\r\n\t\t\t\t\t\tbefore={<Icon24Add/>}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tСоздать цель\r\n\t\t\t\t\t</CellButton>\r\n\t\t\t\t</FormLayout>\r\n\t\t\t</ModalPage>\r\n\t\t</ModalRoot>\r\n\t)\r\n\r\n\treturn (\r\n\t\t<InfoSnackbar>\r\n\t\t\t<PopoutWrapper alignY=\"center\" alignX=\"center\">\r\n\t\t\t\t<Root activeView={state.view} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'preloader'}>\r\n\t\t\t\t\t\t<Preloader id={'preloader'}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'startup'}>\r\n\t\t\t\t\t\t<Startup id={'startup'}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'habit-page'}>\r\n\t\t\t\t\t\t<HabitPage id={'habit-page'} habit={habit} setHabit={setHabit}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'home'} modal={modal}>\r\n\t\t\t\t\t\t<Home id='home' habits={state.habits}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</Root>\r\n\t\t\t</PopoutWrapper>\r\n\t\t</InfoSnackbar>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n\r\n","import \"core-js/features/map\";\r\nimport \"core-js/features/set\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport App from \"./App\";\r\nimport {StateProvider} from \"./state\";\r\n\r\nbridge.subscribe(({detail: {type, data}}) => {\r\n  if (type === 'VKWebAppUpdateConfig') {\r\n    const schemeAttribute = document.createAttribute('scheme');\r\n    schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\r\n    document.body.attributes.setNamedItem(schemeAttribute);\r\n  }\r\n});\r\n// Init VK  Mini App\r\nbridge.send(\"VKWebAppInit\");\r\n\r\nReactDOM.render(\r\n  <StateProvider>\r\n    <App />\r\n  </StateProvider>,\r\n  document.getElementById(\"root\")\r\n);\r\nif (process.env.NODE_ENV === \"development\") {\r\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\r\n}\r\n"],"sourceRoot":""}