{"version":3,"sources":["state/index.js","state/actions.js","hooks/useApi.js","components/HabitBanner.js","components/HabitList.js","panels/Home.js","hooks/useLocalStorage.js","panels/Startup.js","panels/Preloader.js","panels/Habit.js","components/InfoSnackbar.js","App.js","index.js"],"names":["initialState","view","panel","history","activeModal","habits","error","successMessage","popout","allowNotifications","queryString","parse","window","location","search","vk_are_notifications_enabled","reducer","state","action","type","pushState","payload","backElement","length","newHistory","pop","modal","habitId","index","findIndex","item","_id","habit","message","State","createContext","StateProvider","children","value","useReducer","Provider","url","useState","isLoading","setLoading","response","setResponse","setError","options","setOptions","useContext","dispatch","doApiFetch","useCallback","method","params","bodyFields","axiosOptions","baseURL","process","headers","data","useEffect","a","axios","then","catch","e","Error","fetchData","HabitBanner","isSingle","setHabit","useApi","needFetch","setNeedFetch","key","header","title","data-id","onClick","subheader","status","daysComplete","days","notification","style","display","alignItems","margin","marginTop","actions","size","disabled","mode","asideMode","HabitList","map","Home","id","contextOpened","setContextOpened","aside","transform","opened","onClose","weight","before","bridge","send","icon","stretched","paddingBottom","vertical","className","initialValue","localStorage","getItem","setValue","setLocalStorageValue","setItem","templates","buttonText","placeholderText","placeholder","Startup","useLocalStorage","setDone","dispatchStartup","Preloader","doneStartup","done","JSON","HabitPage","left","actionsLayout","autoclose","InfoSnackbar","snackbar","setSnackbar","color","getTime","date","Date","h","getHours","m","getMinutes","timeStr","App","setTitle","setDays","needNotification","setNeedNotification","notificationTime","setNotificationTime","apiStr","setApiStr","subscribe","detail","time","find","modalBack","onpopstate","dynamicContentHeight","onSubmit","preventDefault","timeZoneOffset","getTimezoneOffset","required","onChange","currentTarget","top","bottom","min","max","step","d","checked","alignY","alignX","activeView","activePanel","Habit","schemeAttribute","document","createAttribute","scheme","body","attributes","setNamedItem","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.464be515.chunk.js","sourcesContent":["import {\r\n\tSET_VIEW,\r\n\tSET_PANEL,\r\n\tSET_MODAL,\r\n\tSET_HABITS,\r\n\tSET_ERROR,\r\n\tSET_HISTORY_BACK,\r\n\tSET_HABIT_ID, SET_CHANGE_HABIT, SET_POPOUT, SET_SUCCESS_MESSAGE, SET_ALLOW_NOTIFICATIONS, SET_DENY_NOTIFICATIONS\r\n} from \"./actions\";\r\nimport queryString from \"query-string\";\r\nimport React, {createContext, useReducer} from 'react';\r\n\r\nconst initialState = {\r\n\tview: 'preloader',\r\n\tpanel: 'preloader',\r\n\thistory: [],\r\n\tactiveModal: null,\r\n\thabits: [],\r\n\terror: null,\r\n\tsuccessMessage: null,\r\n\tpopout: null,\r\n\tallowNotifications: queryString.parse(window.location.search).vk_are_notifications_enabled === '1'\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase SET_VIEW:\r\n\t\t\twindow.history.pushState({view: state.view, panel: state.panel}, `${state.view}.${state.panel}`, window.location.search);\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tview: action.payload.view,\r\n\t\t\t\tpanel: action.payload.panel,\r\n\t\t\t\thistory: [...state.history, {view: action.payload.view, panel: action.payload.panel}]\r\n\t\t\t}\r\n\t\tcase SET_PANEL:\r\n\t\t\twindow.history.pushState({view: state.view, panel: state.panel}, `${state.view}.${state.panel}`, window.location.search);\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpanel: action.payload.panel,\r\n\t\t\t\thistory: [...state.history, {view: state.view, panel: action.payload.panel}]\r\n\t\t\t}\r\n\t\tcase SET_HISTORY_BACK:\r\n\t\t\tconst backElement = state.history[state.history.length-2];\r\n\t\t\tif (!backElement) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...state,\r\n\t\t\t\t\tview: 'home',\r\n\t\t\t\t\tpanel: 'home',\r\n\t\t\t\t\thistory: [{view: 'home', panel: 'home'}]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst newHistory = state.history;\r\n\t\t\tnewHistory.pop();\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thistory: [...newHistory],\r\n\t\t\t\tview: backElement.view,\r\n\t\t\t\tpanel: backElement.panel\r\n\t\t\t}\r\n\t\tcase SET_MODAL:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tactiveModal: action.payload.modal\r\n\t\t\t}\r\n\t\tcase SET_HABITS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabits: action.payload.habits\r\n\t\t\t}\r\n\t\tcase SET_HABIT_ID:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabitId: action.payload.habitId\r\n\t\t\t}\r\n\t\tcase SET_CHANGE_HABIT:\r\n\t\t\tconst habits = state.habits;\r\n\t\t\tconst index = habits.findIndex(item => {\r\n\t\t\t\treturn item._id === action.payload.habit?._id\r\n\t\t\t});\r\n\t\t\thabits[index] = action.payload.habit;\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\thabits: [...habits]\r\n\t\t\t}\r\n\t\tcase SET_SUCCESS_MESSAGE:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tsuccessMessage: action.payload.message\r\n\t\t\t}\r\n\t\tcase SET_ERROR:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\terror: action.payload.error\r\n\t\t\t}\r\n\t\tcase SET_POPOUT:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tpopout: action.payload.popout\r\n\t\t\t}\r\n\t\tcase SET_ALLOW_NOTIFICATIONS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tallowNotifications: true\r\n\t\t\t}\r\n\t\tcase SET_DENY_NOTIFICATIONS:\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tallowNotifications: false\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n\r\nexport const State = createContext();\r\n\r\nexport const StateProvider = ({children}) => {\r\n\tconst value = useReducer(reducer, initialState);\r\n\treturn (\r\n\t\t<State.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</State.Provider>\r\n\t)\r\n}","export const SET_VIEW = 'SET_VIEW';\r\nexport const SET_PANEL = 'SET_PANEL';\r\nexport const SET_MODAL = 'SET_MODAL';\r\nexport const SET_HABITS = 'SET_HABITS';\r\nexport const SET_ERROR = 'SET_ERROR';\r\nexport const SET_HISTORY_BACK = 'SET_HISTORY_BACK';\r\nexport const SET_HABIT_ID = 'SET_HABIT_ID';\r\nexport const SET_CHANGE_HABIT = 'SET_CHANGE_HABIT';\r\nexport const SET_POPOUT = 'SET_POPOUT';\r\nexport const SET_SUCCESS_MESSAGE = 'SET_SUCCESS_MESSAGE';\r\nexport const SET_ALLOW_NOTIFICATIONS = 'SET_ALLOW_NOTIFICATIONS';\r\nexport const SET_DENY_NOTIFICATIONS = 'SET_DENY_NOTIFICATIONS';","import React, {useState, useEffect, useCallback, useContext} from 'react';\r\nimport queryString from 'query-string';\r\nimport axios from 'axios';\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_POPOUT, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport {PopoutWrapper, ScreenSpinner} from \"@vkontakte/vkui\";\r\n\r\nexport default url => {\r\n\tconst [isLoading, setLoading] = useState(false);\r\n\tconst [response, setResponse] = useState(null);\r\n\tconst [error, setError] = useState(null);\r\n\tconst [options, setOptions] = useState({});\r\n\tconst [state, dispatch] = useContext(State);\r\n\r\n\tconst apiBase = process.env.NODE_ENV !== 'development' ? process.env.REACT_APP_BASEURL : process.env.REACT_APP_BASEURL_DEV;\r\n\r\n\tconst doApiFetch = useCallback((options = {}) => {\r\n\t\tsetOptions(options);\r\n\t\tsetResponse(null);\r\n\t\tsetError(null);\r\n\t\tsetLoading(true);\r\n\t\tdispatch({type: SET_POPOUT, payload: {popout: (<PopoutWrapper><ScreenSpinner /></PopoutWrapper>)}})\r\n\t}, [dispatch]);\r\n\r\n\tconst {method = 'GET', params, ...bodyFields} = options;\r\n\tconst headers = {\r\n\t\t'Content-Type': 'application/json',\r\n\t}\r\n\tconst { allowNotifications } = state;\r\n\tconst axiosOptions = {\r\n\t\tmethod: method,\r\n\t\tbaseURL: apiBase,\r\n\t\turl,\r\n\t\theaders,\r\n\t\tparams: params ? {...params, ...queryString.parse(window.location.search), allowNotifications} : {...queryString.parse(window.location.search), allowNotifications},\r\n\t\tdata: method !== 'GET' ? bodyFields : null,\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isLoading) return;\r\n\t\tconst fetchData = async () => {\r\n\t\t\tawait setLoading(false);\r\n\t\t\treturn await axios(axiosOptions)\r\n\t\t\t\t.then(async(response) => {\r\n\t\t\t\t\tawait setResponse(response.data.data);\r\n\t\t\t\t\tawait dispatch({type: SET_POPOUT, payload: {popout: null}});\r\n\t\t\t\t\tawait dispatch({type: SET_SUCCESS_MESSAGE, payload: {message: response.data.message}});\r\n\t\t\t\t})\r\n\t\t\t\t.catch((error) => {\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\tlet e = error?.response ? error.response.data.error : new Error('Проблемы с подключением к API');\r\n\t\t\t\t\tsetError(e);\r\n\t\t\t\t\tdispatch({type: SET_POPOUT, payload: {popout: null}})\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: e}});\r\n\t\t\t\t})\r\n\t\t}\r\n\r\n\t\tfetchData();\r\n\t}, [isLoading, axiosOptions, dispatch]);\r\n\treturn [{isLoading, response, error}, doApiFetch];\r\n}","import React, {useEffect, useState} from 'react';\r\nimport {SET_HABIT_ID, SET_VIEW} from \"../state/actions\";\r\nimport {Banner, Button, InfoRow, Progress} from \"@vkontakte/vkui\";\r\nimport useApi from \"../hooks/useApi\";\r\nimport Icon24NotificationOutline from '@vkontakte/icons/dist/24/notification_outline';\r\n\r\nconst HabitBanner = ({habit, dispatch, isSingle = false, setHabit = () => {}}) => {\r\n\tconst [{response}, doApiFetch] = useApi(`/habit/${habit?._id}`);\r\n\r\n\tconst [needFetch, setNeedFetch] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'PUT'\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [needFetch, doApiFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tsetHabit(response);\r\n\t}, [response, setHabit]);\r\n\r\n\treturn (\r\n\t\t<Banner\r\n\t\t\tkey={habit?._id}\r\n\t\t\theader={habit?.title}\r\n\t\t\tdata-id={habit?._id}\r\n\t\t\tonClick={() => {\r\n\t\t\t\tif (!isSingle) {\r\n\t\t\t\t\tdispatch({type: SET_VIEW, payload: { view: 'habit-page', panel: 'habit-page'}});\r\n\t\t\t\t\tdispatch({type: SET_HABIT_ID, payload: { habitId: habit?._id}});\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}}\r\n\t\t\tsubheader={\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<InfoRow header={\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<p>Статус: <strong>{habit?.status === 'active' ? 'Активно' : 'Выполнено'}</strong></p>\r\n\t\t\t\t\t\t\t<p>Дней подряд: <strong>{habit?.daysComplete}</strong> / <strong>{habit?.days}</strong></p>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\thabit?.notification\r\n\t\t\t\t\t\t\t\t&&\r\n\t\t\t\t\t\t\t\t<div style={{display: 'flex', alignItems: 'center'}}>\r\n\t\t\t\t\t\t\t\t\t<Icon24NotificationOutline/>\r\n\t\t\t\t\t\t\t\t\t<p style={{margin: 0}}>\r\n\t\t\t\t\t\t\t\t\t\t{habit?.notification}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}>\r\n\t\t\t\t\t\t<Progress value={(habit?.daysComplete/habit?.days)*100}  style={{marginTop: '1em'}}/>\r\n\t\t\t\t\t</InfoRow>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\tactions={isSingle &&\r\n\t\t\t\t<Button\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tsetNeedFetch(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tsize={'xl'}\r\n\t\t\t\t\tdisabled={habit?.daysComplete === habit?.days}\r\n\t\t\t\t>\r\n\t\t\t\t\t{habit?.daysComplete === habit?.days ? 'Цель достигнута' : 'Выполнить на сегодня'}\r\n\t\t\t\t</Button>\r\n\t\t\t}\r\n\t\t\tmode={'tint'}\r\n\t\t\tasideMode={!isSingle && 'expand'}\r\n\t\t/>\r\n\t)\r\n}\r\n\r\nexport default HabitBanner;\r\n","import React, { useContext } from 'react';\r\nimport {State} from \"../state\";\r\nimport HabitBanner from \"./HabitBanner\";\r\n\r\nconst HabitList = ({habits}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\treturn habits.map((habit) => {\r\n\t\treturn (\r\n\t\t\t<HabitBanner key={habit._id} habit={habit} dispatch={dispatch} />\r\n\t\t)\r\n\t})\r\n}\r\n\r\nexport default HabitList;\r\n","import React, {useContext, useState} from 'react';\nimport bridge from '@vkontakte/vk-bridge';\nimport PropTypes from 'prop-types';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport {\n\tButton,\n\tCellButton,\n\tDiv,\n\tFixedLayout,\n\tFormLayout,\n\tGroup,\n\tHeadline,\n\tList,\n\tPanelHeaderContent,\n\tPanelHeaderContext,\n\tPlaceholder,\n\tText\n} from \"@vkontakte/vkui\";\nimport Icon24Add from '@vkontakte/icons/dist/24/add';\nimport Icon16Dropdown from '@vkontakte/icons/dist/16/dropdown';\nimport Icon28ShareExternalOutline from '@vkontakte/icons/dist/28/share_external_outline';\nimport Icon56DiamondOutline from '@vkontakte/icons/dist/56/diamond_outline';\nimport Icon28NotificationDisableOutline from '@vkontakte/icons/dist/28/notification_disable_outline';\nimport Icon28Notifications from '@vkontakte/icons/dist/28/notifications';\nimport {State} from \"../state\";\nimport {SET_MODAL} from \"../state/actions\";\nimport HabitList from \"../components/HabitList\";\n\nimport './style.css';\n\nconst Home = ({id, habits}) => {\n\tconst [state, dispatch] = useContext(State);\n\tconst [contextOpened, setContextOpened] = useState(false);\n\n\treturn (\n\t\t<Panel id={id}>\n\t\t\t<PanelHeader>\n\t\t\t\t<PanelHeaderContent\n\t\t\t\t\taside={<Icon16Dropdown style={{transform: `rotate(${contextOpened ? '180deg' : '0'})`}}/>}\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tsetContextOpened(!contextOpened)\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tHabit\n\t\t\t\t</PanelHeaderContent>\n\t\t\t</PanelHeader>\n\t\t\t<PanelHeaderContext opened={contextOpened} onClose={() => {\n\t\t\t\tsetContextOpened(!contextOpened)\n\t\t\t}}>\n\t\t\t\t<List>\n\t\t\t\t\t<Div>\n\t\t\t\t\t\t<Headline weight={'semibold'}>О приложении</Headline>\n\t\t\t\t\t\t<Text>Habit - Ваш личный помошник в формировании привычек. Приложение помогает развить хорошие привычки и\n\t\t\t\t\t\t\tизбавиться от плохих.</Text>\n\t\t\t\t\t</Div>\n\t\t\t\t\t<CellButton\n\t\t\t\t\t\tbefore={<Icon28ShareExternalOutline/>}\n\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\tbridge.send('VKWebAppShare', {'link': 'https://vk.com/app7564973'})\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\tПоделиться приложением\n\t\t\t\t\t</CellButton>\n\t\t\t\t\t{\n\t\t\t\t\t\tstate.allowNotifications ?\n\t\t\t\t\t\t\t<CellButton\n\t\t\t\t\t\t\t\tbefore={<Icon28NotificationDisableOutline/>}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tbridge.send('VKWebAppDenyNotifications');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tОтключить уведомления\n\t\t\t\t\t\t\t</CellButton>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t<CellButton\n\t\t\t\t\t\t\t\tbefore={<Icon28Notifications/>}\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tbridge.send('VKWebAppAllowNotifications');\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tВключить уведомления\n\t\t\t\t\t\t\t</CellButton>\n\t\t\t\t\t}\n\t\t\t\t</List>\n\t\t\t</PanelHeaderContext>\n\t\t\t{habits.length === 0\n\t\t\t\t?\n\t\t\t\t<Placeholder\n\t\t\t\t\ticon={<Icon56DiamondOutline/>}\n\t\t\t\t\taction={\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tsize=\"l\"\n\t\t\t\t\t\t\tmode=\"tertiary\"\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-habit'}})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tСоздать первую цель\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t}\n\t\t\t\t\tstretched\n\t\t\t\t>\n\t\t\t\t\tФормируйте свои привычки самостоятельно. Создайте первую цель и следуйте к ней\n\t\t\t\t</Placeholder>\n\t\t\t\t:\n\t\t\t\t<Group style={{paddingBottom: '60px'}}>\n\t\t\t\t\t<HabitList habits={habits}/>\n\t\t\t\t</Group>\n\t\t\t}\n\t\t\t{habits.length !==0 &&\n\t\t\t\t<FixedLayout\n\t\t\t\t\tvertical={'bottom'}\n\t\t\t\t\tclassName={'fixed-button'}\n\t\t\t\t>\n\t\t\t\t\t<FormLayout>\n\t\t\t\t\t\t<CellButton\n\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-habit'}})\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tbefore={<Icon24Add/>}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tСоздать цель\n\t\t\t\t\t\t</CellButton>\n\t\t\t\t\t</FormLayout>\n\t\t\t\t</FixedLayout>\n\t\t\t}\n\t\t</Panel>\n\t)\n};\n\nHome.propTypes = {\n\tid: PropTypes.string.isRequired,\n};\n\nexport default Home;\n","import { useState } from 'react';\r\n\r\nexport default (key, initialValue = '') => {\r\n\tconst [value, setValue] = useState(() => {\r\n\t\treturn localStorage.getItem(key) || initialValue;\r\n\t});\r\n\r\n\tconst setLocalStorageValue = (value) => {\r\n\t\tsetValue(value);\r\n\t\tlocalStorage.setItem(key, value)\r\n\t}\r\n\r\n\treturn [value, setLocalStorageValue];\r\n}","import React, {useContext, useReducer} from 'react';\r\nimport {Button, Div, Panel, PanelHeader, Placeholder} from \"@vkontakte/vkui\";\r\nimport Icon56EventOutline from '@vkontakte/icons/dist/56/event_outline';\r\nimport {State} from \"../state\";\r\nimport {SET_VIEW} from \"../state/actions\";\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\n\r\nconst templates = [\r\n\t{\r\n\t\tid: 1,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Формирование привычки',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'В психологии давно установлен факт, что 21 дня достаточно, чтобы привить новые привычки (избавиться от старых) и таким образом улучшить качество жизни',\r\n\t},\r\n\t{\r\n\t\tid: 2,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Поставьте цель и идите к ней',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'Создайте в приложении цель (привычку, которую хотите изменить) и отмечайте ее успешное ежедневное выполнение',\r\n\t},\r\n\t{\r\n\t\tid: 3,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'В формировании привычки важна регулярность',\r\n\t\tbuttonText: 'Начать',\r\n\t\tplaceholderText: 'В случае пропуска ежедневной отметки прогресс сбрасывается, но вы можете запустить счетчик сначала',\r\n\t},\r\n]\r\n\r\nconst initialState = {\r\n\tplaceholder: {\r\n\t\tid: 1,\r\n\t\ticon: (<Icon56EventOutline/>),\r\n\t\theader: 'Формирование привычки',\r\n\t\tbuttonText: 'Далее',\r\n\t\tplaceholderText: 'В психологии давно установлен факт, что 21 дня достаточно, чтобы привить новые привычки (избавиться от старых) и таким образом улучшить качество жизни',\r\n\r\n\t}\r\n}\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'SET_PLACEHOLDER':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tplaceholder: action.payload.placeholder\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn state\r\n\t}\r\n}\r\nconst Startup = ({id}) => {\r\n\tconst [, setDone] = useLocalStorage('startup-done');\r\n\tconst [{placeholder}, dispatchStartup] = useReducer(reducer, initialState);\r\n\tconst [, dispatch] = useContext(State);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<PanelHeader>Введение</PanelHeader>\r\n\t\t\t<Placeholder\r\n\t\t\t\ticon={placeholder.icon}\r\n\t\t\t\theader={placeholder.header}\r\n\t\t\t\taction={\r\n\t\t\t\t\t[<Div key={'action'}>\r\n\t\t\t\t\t\t<Button onClick={\r\n\t\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\t\tif (placeholder.id < 3) {\r\n\t\t\t\t\t\t\t\t\tdispatchStartup({\r\n\t\t\t\t\t\t\t\t\t\ttype: 'SET_PLACEHOLDER', payload: {\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder: templates[placeholder.id],\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t\t\t\tsetDone('true');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{placeholder.buttonText}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</Div>,\r\n\t\t\t\t\t<Div key={'skip'}>\r\n\t\t\t\t\t\t{placeholder.id !== 3 && <Button\r\n\t\t\t\t\t\t\tmode={'tertiary'}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t\t\t\t\t\tsetDone('true');\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tПропустить\r\n\t\t\t\t\t\t</Button>}\r\n\t\t\t\t\t</Div>\r\n\t\t\t\t\t]\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{placeholder.placeholderText}\r\n\t\t\t</Placeholder>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default Startup;\r\n","import React, {useEffect, useContext} from 'react';\r\nimport {Panel} from \"@vkontakte/vkui\";\r\nimport useLocalStorage from \"../hooks/useLocalStorage\";\r\nimport {State} from \"../state\";\r\nimport {SET_VIEW} from \"../state/actions\";\r\n\r\nconst Preloader = ({id}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\tconst [doneStartup] = useLocalStorage('startup-done');\r\n\tuseEffect(() => {\r\n\t\tif (!doneStartup) {\r\n\t\t\tdispatch({type: SET_VIEW, payload: {view: 'startup', panel: 'startup'}});\r\n\t\t} else {\r\n\t\t\tconst done = JSON.parse(doneStartup);\r\n\t\t\tif (done) {\r\n\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'home', panel: 'home'}});\r\n\t\t\t} else {\r\n\t\t\t\tdispatch({type: SET_VIEW, payload: {view: 'startup', panel: 'startup'}});\r\n\t\t\t}\r\n\t\t}\r\n\t}, [dispatch, doneStartup]);\r\n\treturn (\r\n\t\t<Panel id={id}>\r\n\t\t\t<div>Habit</div>\r\n\t\t</Panel>\r\n\t)\r\n}\r\n\r\nexport default Preloader;\r\n","import React, {useContext, useEffect, useState} from 'react';\r\nimport bridge from '@vkontakte/vk-bridge';\r\nimport {Alert, CellButton, List, PanelHeader, PanelHeaderBack} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport useApi from \"../hooks/useApi\";\r\nimport {SET_CHANGE_HABIT, SET_HABIT_ID, SET_HABITS, SET_HISTORY_BACK, SET_MODAL, SET_POPOUT} from \"../state/actions\";\r\nimport HabitBanner from \"../components/HabitBanner\";\r\n\r\nimport Icon28ShareOutline from '@vkontakte/icons/dist/28/share_outline';\r\nimport Icon28CancelCircleOutline from '@vkontakte/icons/dist/28/cancel_circle_outline';\r\nimport Icon28EditOutline from '@vkontakte/icons/dist/28/edit_outline';\r\n\r\nconst HabitPage = ({habit, setHabit}) => {\r\n\tconst [, dispatch] = useContext(State);\r\n\tconst [{response}, doApiFetch] = useApi(`/habit/${habit?._id}`);\r\n\r\n\tconst [needFetch, setNeedFetch] = useState(false);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch({\r\n\t\t\tmethod: 'DELETE'\r\n\t\t});\r\n\t\tsetNeedFetch(false);\r\n\t}, [needFetch, doApiFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_HABITS, payload: {habits: response}});\r\n\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t// setHabit(response);\r\n\t}, [response, dispatch]);\r\n\r\n\tconst message = habit?.days !== habit?.daysComplete\r\n\t\t?\r\n\t\t`Успешно иду к своей цели ${habit?.title}. Уже ${habit?.daysComplete} дней подряд из ${habit?.days}. https://vk.com/app7564973`\r\n\t\t:\r\n\t\t`Успешно выполнил поставленую цель ${habit?.title}. https://vk.com/app7564973`\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<PanelHeader left={\r\n\t\t\t\t<PanelHeaderBack\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t\t\t\tdispatch({type: SET_HABIT_ID, payload: {habitId: null}});\r\n\t\t\t\t\t\tdispatch({type: SET_CHANGE_HABIT, payload: {habit: null}});\r\n\t\t\t\t\t\tsetHabit(null);\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t{habit?.title}\r\n\t\t\t</PanelHeader>\r\n\t\t\t<HabitBanner habit={habit} dispatch={dispatch} isSingle={true} setHabit={setHabit}/>\r\n\t\t\t<List>\r\n\t\t\t\t<CellButton\r\n\t\t\t\t\tbefore={<Icon28EditOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: 'add-habit'}});\r\n\t\t\t\t\t}}\r\n\t\t\t\t>Редактировать</CellButton>\r\n\t\t\t\t<CellButton\r\n\t\t\t\t\tbefore={<Icon28ShareOutline/>}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tbridge.send('VKWebAppShowWallPostBox', {message: message})\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{habit?.days !== habit?.daysComplete ? 'Поделиться прогрессом' : 'Поделиться успехом'}\r\n\t\t\t\t</CellButton>\r\n\t\t\t\t<CellButton\r\n\t\t\t\t\tbefore={<Icon28CancelCircleOutline/>}\r\n\t\t\t\t\tmode={'danger'}\r\n\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\tdispatch({\r\n\t\t\t\t\t\t\ttype: SET_POPOUT, payload: {\r\n\t\t\t\t\t\t\t\tpopout: (\r\n\t\t\t\t\t\t\t\t\t<Alert\r\n\t\t\t\t\t\t\t\t\t\tactionsLayout=\"vertical\"\r\n\t\t\t\t\t\t\t\t\t\tactions={[{\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Удалить',\r\n\t\t\t\t\t\t\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\t\t\t\t\t\t\tmode: 'destructive',\r\n\t\t\t\t\t\t\t\t\t\t\taction: () => setNeedFetch(true),\r\n\t\t\t\t\t\t\t\t\t\t}, {\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: 'Отмена',\r\n\t\t\t\t\t\t\t\t\t\t\tautoclose: true,\r\n\t\t\t\t\t\t\t\t\t\t\tmode: 'cancel'\r\n\t\t\t\t\t\t\t\t\t\t}]}\r\n\t\t\t\t\t\t\t\t\t\tonClose={() => {dispatch({type: SET_POPOUT, payload: {popout: null}})}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<h2>Подтвердите действие</h2>\r\n\t\t\t\t\t\t\t\t\t\t<p>Вы уверены, что хотите удалить {habit?.title}?</p>\r\n\t\t\t\t\t\t\t\t\t\t<p><i>Отменить удаление будет невозможно!</i></p>\r\n\t\t\t\t\t\t\t\t\t</Alert>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\tУдалить цель\r\n\t\t\t\t</CellButton>\r\n\t\t\t</List>\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default HabitPage;\r\n","import React, {useContext, useEffect, useState} from 'react';\r\nimport {Snackbar} from \"@vkontakte/vkui\";\r\nimport {State} from \"../state\";\r\nimport {SET_ERROR, SET_SUCCESS_MESSAGE} from \"../state/actions\";\r\nimport Icon24ErrorCircle from '@vkontakte/icons/dist/24/error_circle';\r\nimport Icon24CheckCircleOn from '@vkontakte/icons/dist/24/check_circle_on';\r\n\r\nconst InfoSnackbar = ({children}) => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [snackbar, setSnackbar] = useState(null);\r\n\tuseEffect(() => {\r\n\t\tif (!state.error) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_ERROR, payload: {error: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24ErrorCircle style={{color: 'var(--destructive)'}}/>}\r\n\t\t>\r\n\t\t\t{state.error.message}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.error]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.successMessage) return;\r\n\t\tsetSnackbar(<Snackbar\r\n\t\t\tonClose={\r\n\t\t\t\t() => {\r\n\t\t\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: null}});\r\n\t\t\t\t\tsetSnackbar(null);\r\n\t\t\t\t}}\r\n\t\t\tbefore={<Icon24CheckCircleOn style={{color: 'var(--accent)'}}/>}\r\n\t\t>\r\n\t\t\t{state.successMessage}\r\n\t\t</Snackbar>)\r\n\t}, [setSnackbar, dispatch, state.successMessage]);\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{children}\r\n\t\t\t{snackbar}\r\n\t\t</>\r\n\t)\r\n}\r\n\r\nexport default InfoSnackbar;\r\n","import React, {useContext, useEffect, useState} from 'react';\r\nimport View from '@vkontakte/vkui/dist/components/View/View';\r\nimport '@vkontakte/vkui/dist/vkui.css';\r\n\r\nimport Home from './panels/Home';\r\nimport {State} from \"./state\";\r\nimport {\r\n\tButton, Checkbox,\r\n\tFormLayout,\r\n\tInput,\r\n\tModalCard,\r\n\tModalRoot,\r\n\tPanel,\r\n\tPopoutWrapper,\r\n\tRoot,\r\n\tSlider\r\n} from \"@vkontakte/vkui\";\r\nimport Startup from \"./panels/Startup\";\r\nimport Preloader from \"./panels/Preloader\";\r\nimport {\r\n\tSET_ALLOW_NOTIFICATIONS,\r\n\tSET_DENY_NOTIFICATIONS,\r\n\tSET_HABITS,\r\n\tSET_HISTORY_BACK,\r\n\tSET_MODAL,\r\n\tSET_SUCCESS_MESSAGE\r\n} from \"./state/actions\";\r\nimport Icon28AddSquareOutline from '@vkontakte/icons/dist/28/add_square_outline';\r\nimport Icon28ListCheckOutline from '@vkontakte/icons/dist/28/list_check_outline';\r\nimport useApi from \"./hooks/useApi\";\r\nimport HabitPage from \"./panels/Habit\";\r\nimport InfoSnackbar from \"./components/InfoSnackbar\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\n\r\nconst getTime = () => {\r\n\tconst date = new Date();\r\n\tconst h = date.getHours();\r\n\tconst m = date.getMinutes();\r\n\tlet timeStr = h < 10 ? `0${h}:` : `${h}:`;\r\n\ttimeStr += m < 10 ? `0${m}` : m;\r\n\treturn timeStr;\r\n}\r\n\r\nconst App = () => {\r\n\tconst [state, dispatch] = useContext(State);\r\n\tconst [title, setTitle] = useState('');\r\n\tconst [days, setDays] = useState(21);\r\n\tconst [needNotification, setNeedNotification] = useState(false);\r\n\tconst [notificationTime, setNotificationTime] = useState(() => {\r\n\t\treturn getTime();\r\n\t});\r\n\tconst [apiStr, setApiStr] = useState('/habit');\r\n\tconst [{response}, doApiFetch] = useApi(apiStr);\r\n\tconst [needFetch, setNeedFetch] = useState(true);\r\n\tconst [habit, setHabit] = useState(null);\r\n\r\n\tbridge.subscribe(({detail: {type}}) => {\r\n\t\tif (type === 'VKWebAppShareResult' || type === 'VKWebAppShowWallPostBoxResult') {\r\n\t\t\tdispatch({type: SET_SUCCESS_MESSAGE, payload: {message: 'Запись опубликована'}});\r\n\t\t}\r\n\t\tif (type === 'VKWebAppAllowNotificationsResult') {\r\n\t\t\tdispatch({type: SET_ALLOW_NOTIFICATIONS});\r\n\t\t}\r\n\t\tif (type === 'VKWebAppDenyNotificationsResult') {\r\n\t\t\tdispatch({type: SET_DENY_NOTIFICATIONS});\r\n\t\t}\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!habit) {\r\n\t\t\tsetTitle('');\r\n\t\t\tsetDays(21);\r\n\t\t\tsetNeedNotification(false);\r\n\t\t\tsetNotificationTime(() => {\r\n\t\t\t\treturn getTime();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconst time = getTime();\r\n\t\t\tsetTitle(habit?.title);\r\n\t\t\tsetDays(habit?.days);\r\n\t\t\tsetNeedNotification(!!habit?.notification);\r\n\t\t\tsetNotificationTime(habit?.notification || time);\r\n\t\t}\r\n\r\n\t}, [habit]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!needFetch) return;\r\n\t\tdoApiFetch();\r\n\t\tsetNeedFetch(false);\r\n\t}, [doApiFetch, needFetch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) return;\r\n\t\tdispatch({type: SET_HABITS, payload: {habits: response}});\r\n\t}, [response, dispatch]);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!state.habitId) return;\r\n\t\tsetHabit(state.habits.find((item) => {\r\n\t\t\treturn item._id === state.habitId\r\n\t\t}));\r\n\t}, [state.habitId, state.habits])\r\n\r\n\tconst modalBack = () => {\r\n\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\twindow.onpopstate = () => {\r\n\t\t\tif (state.view !== 'home' && state.panel !== 'home') {\r\n\t\t\t\tdispatch({type: SET_HISTORY_BACK});\r\n\t\t\t}\r\n\t\t}\r\n\t}, [dispatch, state.panel, state.view]);\r\n\r\n\tconst modal = (\r\n\t\t<ModalRoot\r\n\t\t\tactiveModal={state.activeModal}\r\n\t\t\tonClose={modalBack}\r\n\t\t>\r\n\t\t\t<ModalCard\r\n\t\t\t\tid={'add-habit'}\r\n\t\t\t\tonClose={modalBack}\r\n\t\t\t\tdynamicContentHeight\r\n\t\t\t\theader={'Создать цель'}\r\n\t\t\t>\r\n\t\t\t\t<FormLayout\r\n\t\t\t\t\tid={'habit-add-form'}\r\n\t\t\t\t\tonSubmit={(e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tsetApiStr(habit ? `/habit/${habit?._id}` : '/habit');\r\n\t\t\t\t\t\tdoApiFetch({\r\n\t\t\t\t\t\t\tmethod: habit ? 'PATCH' : 'POST',\r\n\t\t\t\t\t\t\ttitle: title,\r\n\t\t\t\t\t\t\tdays: days,\r\n\t\t\t\t\t\t\ttime: needNotification ? notificationTime : null,\r\n\t\t\t\t\t\t\ttimeZoneOffset: new Date().getTimezoneOffset()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tdispatch({type: SET_MODAL, payload: {modal: null}});\r\n\t\t\t\t\t\tif (!habit) {\r\n\t\t\t\t\t\t\tsetNeedNotification(false);\r\n\t\t\t\t\t\t\tsetDays(21);\r\n\t\t\t\t\t\t\tsetTitle('');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\trequired\r\n\t\t\t\t\t\ttype={'text'}\r\n\t\t\t\t\t\tvalue={title}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tif (e.currentTarget.value.length <= 20) {\r\n\t\t\t\t\t\t\t\tsetTitle(e.currentTarget.value)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ttop={'Название цели'}\r\n\t\t\t\t\t\tbottom={`Введено: ${title.length} из 20`}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Slider min={1} max={21} step={1} value={days} top={`Кол-во дней: ${days}`} onChange={(d) => {\r\n\t\t\t\t\t\tsetDays(d)\r\n\t\t\t\t\t}}/>\r\n\t\t\t\t\t<Checkbox\r\n\t\t\t\t\t\ttype={'checkbox'}\r\n\t\t\t\t\t\tchecked={needNotification}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\t\tcurrentTarget: {\r\n\t\t\t\t\t\t\t\t\tchecked\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} = e;\r\n\t\t\t\t\t\t\tif (checked) {\r\n\t\t\t\t\t\t\t\tif (!state.allowNotifications){\r\n\t\t\t\t\t\t\t\t\tbridge.send('VKWebAppAllowNotifications');\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetNeedNotification(e.currentTarget.checked);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>Включить оповещения</Checkbox>\r\n\t\t\t\t\t<Input\r\n\t\t\t\t\t\ttype={'time'}\r\n\t\t\t\t\t\tvalue={notificationTime}\r\n\t\t\t\t\t\tdisabled={!needNotification}\r\n\t\t\t\t\t\tonChange={(e) => {\r\n\t\t\t\t\t\t\tsetNotificationTime(e.currentTarget.value);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tbefore={habit ? <Icon28ListCheckOutline/> : <Icon28AddSquareOutline/>}\r\n\t\t\t\t\t\tsize={'xl'}\r\n\t\t\t\t\t\tstyle={{paddingBottom: 0}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{habit ? 'Обновить цель' : 'Создать цель'}\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</FormLayout>\r\n\t\t\t</ModalCard>\r\n\t\t</ModalRoot>\r\n\t)\r\n\r\n\treturn (\r\n\t\t<InfoSnackbar>\r\n\t\t\t<PopoutWrapper alignY=\"center\" alignX=\"center\">\r\n\t\t\t\t<Root activeView={state.view} popout={state.popout} modal={modal}>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'preloader'}>\r\n\t\t\t\t\t\t<Preloader id={'preloader'}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'startup'}>\r\n\t\t\t\t\t\t<Startup id={'startup'}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'habit-page'}>\r\n\t\t\t\t\t\t<Panel id={'habit-page'}>\r\n\t\t\t\t\t\t\t<HabitPage habit={habit} setHabit={setHabit}/>\r\n\t\t\t\t\t\t</Panel>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t\t<View activePanel={state.panel} id={'home'}>\r\n\t\t\t\t\t\t<Home id='home' habits={state.habits}/>\r\n\t\t\t\t\t</View>\r\n\t\t\t\t</Root>\r\n\t\t\t</PopoutWrapper>\r\n\t\t</InfoSnackbar>\r\n\t);\r\n}\r\n\r\nexport default App;\r\n\r\n","import \"core-js/features/map\";\r\nimport \"core-js/features/set\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport bridge from \"@vkontakte/vk-bridge\";\r\nimport App from \"./App\";\r\nimport {StateProvider} from \"./state\";\r\n\r\nbridge.subscribe(({detail: {type, data}}) => {\r\n  if (type === 'VKWebAppUpdateConfig') {\r\n    const schemeAttribute = document.createAttribute('scheme');\r\n    schemeAttribute.value = data.scheme ? data.scheme : 'client_light';\r\n    document.body.attributes.setNamedItem(schemeAttribute);\r\n  }\r\n});\r\n// Init VK  Mini App\r\nbridge.send(\"VKWebAppInit\");\r\n\r\nReactDOM.render(\r\n  <StateProvider>\r\n    <App />\r\n  </StateProvider>,\r\n  document.getElementById(\"root\")\r\n);\r\nif (process.env.NODE_ENV === \"development\") {\r\n  import(\"./eruda\").then(({ default: eruda }) => {}); //runtime download\r\n}\r\n"],"sourceRoot":""}