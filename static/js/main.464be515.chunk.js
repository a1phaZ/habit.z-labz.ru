(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{195:function(e,t,a){e.exports=a(324)},314:function(e,t,a){},324:function(e,t,a){"use strict";a.r(t);a(196),a(222),a(224),a(225),a(227),a(228),a(229),a(230),a(231),a(232),a(233),a(234),a(236),a(237),a(238),a(239),a(240),a(241),a(242),a(243),a(244),a(245),a(247),a(248),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(257),a(258),a(259),a(260),a(261),a(262),a(263),a(264);var n=a(0),l=a.n(n),o=a(117),c=a.n(o),i=a(23),r=a.n(i),u=a(7),d=a(41),s=a.n(d),p=(a(272),a(139)),b=a.n(p),E=a(140),m=a.n(E),v=a(5),f=a(131),h=a.n(f),O=a(132),y=a.n(O),j=a(133),S=a.n(j),T=a(134),_=a.n(T),w=a(135),C=a.n(w),g=a(136),A=a.n(g),I=a(51),x=a(10),k=a(48),N=a.n(k),H={view:"preloader",panel:"preloader",history:[],activeModal:null,habits:[],error:null,successMessage:null,popout:null,allowNotifications:"1"===N.a.parse(window.location.search).vk_are_notifications_enabled},P=function(e,t){switch(t.type){case"SET_VIEW":return window.history.pushState({view:e.view,panel:e.panel},"".concat(e.view,".").concat(e.panel),window.location.search),Object(x.a)(Object(x.a)({},e),{},{view:t.payload.view,panel:t.payload.panel,history:[].concat(Object(I.a)(e.history),[{view:t.payload.view,panel:t.payload.panel}])});case"SET_PANEL":return window.history.pushState({view:e.view,panel:e.panel},"".concat(e.view,".").concat(e.panel),window.location.search),Object(x.a)(Object(x.a)({},e),{},{panel:t.payload.panel,history:[].concat(Object(I.a)(e.history),[{view:e.view,panel:t.payload.panel}])});case"SET_HISTORY_BACK":var a=e.history[e.history.length-2];if(!a)return Object(x.a)(Object(x.a)({},e),{},{view:"home",panel:"home",history:[{view:"home",panel:"home"}]});var n=e.history;return n.pop(),Object(x.a)(Object(x.a)({},e),{},{history:Object(I.a)(n),view:a.view,panel:a.panel});case"SET_MODAL":return Object(x.a)(Object(x.a)({},e),{},{activeModal:t.payload.modal});case"SET_HABITS":return Object(x.a)(Object(x.a)({},e),{},{habits:t.payload.habits});case"SET_HABIT_ID":return Object(x.a)(Object(x.a)({},e),{},{habitId:t.payload.habitId});case"SET_CHANGE_HABIT":var l=e.habits,o=l.findIndex((function(e){var a;return e._id===(null===(a=t.payload.habit)||void 0===a?void 0:a._id)}));return l[o]=t.payload.habit,Object(x.a)(Object(x.a)({},e),{},{habits:Object(I.a)(l)});case"SET_SUCCESS_MESSAGE":return Object(x.a)(Object(x.a)({},e),{},{successMessage:t.payload.message});case"SET_ERROR":return Object(x.a)(Object(x.a)({},e),{},{error:t.payload.error});case"SET_POPOUT":return Object(x.a)(Object(x.a)({},e),{},{popout:t.payload.popout});case"SET_ALLOW_NOTIFICATIONS":return Object(x.a)(Object(x.a)({},e),{},{allowNotifications:!0});case"SET_DENY_NOTIFICATIONS":return Object(x.a)(Object(x.a)({},e),{},{allowNotifications:!1});default:return e}},R=Object(n.createContext)(),W=function(e){var t=e.children,a=Object(n.useReducer)(P,H);return l.a.createElement(R.Provider,{value:a},t)},M=a(49),D=a.n(M),L=a(74),V=a(148),B=a(137),K=a.n(B),U=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),o=a[0],c=a[1],i=Object(n.useState)(null),r=Object(u.a)(i,2),d=r[0],s=r[1],p=Object(n.useState)(null),b=Object(u.a)(p,2),E=b[0],m=b[1],f=Object(n.useState)({}),h=Object(u.a)(f,2),O=h[0],y=h[1],j=Object(n.useContext)(R),S=Object(u.a)(j,2),T=S[0],_=S[1],w=Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};y(e),s(null),m(null),c(!0),_({type:"SET_POPOUT",payload:{popout:l.a.createElement(v.v,null,l.a.createElement(v.y,null))}})}),[_]),C=O.method,g=void 0===C?"GET":C,A=O.params,I=Object(V.a)(O,["method","params"]),k=T.allowNotifications,H={method:g,baseURL:"https://habit.z-labz.ru/api",url:e,headers:{"Content-Type":"application/json"},params:A?Object(x.a)(Object(x.a)(Object(x.a)({},A),N.a.parse(window.location.search)),{},{allowNotifications:k}):Object(x.a)(Object(x.a)({},N.a.parse(window.location.search)),{},{allowNotifications:k}),data:"GET"!==g?I:null};return Object(n.useEffect)((function(){o&&function(){var e=Object(L.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(!1);case 2:return e.next=4,K()(H).then(function(){var e=Object(L.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t.data.data);case 2:return e.next=4,_({type:"SET_POPOUT",payload:{popout:null}});case 4:return e.next=6,_({type:"SET_SUCCESS_MESSAGE",payload:{message:t.data.message}});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){c(!1);var t=(null===e||void 0===e?void 0:e.response)?e.response.data.error:new Error("\u041f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c \u043a API");m(t),_({type:"SET_POPOUT",payload:{popout:null}}),_({type:"SET_ERROR",payload:{error:t}})}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[o,H,_]),[{isLoading:o,response:d,error:E},w]},G=a(138),z=a.n(G),Y=function(e){var t=e.habit,a=e.dispatch,o=e.isSingle,c=void 0!==o&&o,i=e.setHabit,r=void 0===i?function(){}:i,d=U("/habit/".concat(null===t||void 0===t?void 0:t._id)),s=Object(u.a)(d,2),p=s[0].response,b=s[1],E=Object(n.useState)(!1),m=Object(u.a)(E,2),f=m[0],h=m[1];return Object(n.useEffect)((function(){f&&(b({method:"PUT"}),h(!1))}),[f,b]),Object(n.useEffect)((function(){p&&r(p)}),[p,r]),l.a.createElement(v.b,{key:null===t||void 0===t?void 0:t._id,header:null===t||void 0===t?void 0:t.title,"data-id":null===t||void 0===t?void 0:t._id,onClick:function(){return c||(a({type:"SET_VIEW",payload:{view:"habit-page",panel:"habit-page"}}),a({type:"SET_HABIT_ID",payload:{habitId:null===t||void 0===t?void 0:t._id}})),null},subheader:l.a.createElement("div",null,l.a.createElement(v.k,{header:l.a.createElement("div",null,l.a.createElement("p",null,"\u0421\u0442\u0430\u0442\u0443\u0441: ",l.a.createElement("strong",null,"active"===(null===t||void 0===t?void 0:t.status)?"\u0410\u043a\u0442\u0438\u0432\u043d\u043e":"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e")),l.a.createElement("p",null,"\u0414\u043d\u0435\u0439 \u043f\u043e\u0434\u0440\u044f\u0434: ",l.a.createElement("strong",null,null===t||void 0===t?void 0:t.daysComplete)," / ",l.a.createElement("strong",null,null===t||void 0===t?void 0:t.days)),(null===t||void 0===t?void 0:t.notification)&&l.a.createElement("div",{style:{display:"flex",alignItems:"center"}},l.a.createElement(z.a,null),l.a.createElement("p",{style:{margin:0}},null===t||void 0===t?void 0:t.notification)))},l.a.createElement(v.w,{value:(null===t||void 0===t?void 0:t.daysComplete)/(null===t||void 0===t?void 0:t.days)*100,style:{marginTop:"1em"}}))),actions:c&&l.a.createElement(v.c,{onClick:function(){h(!0)},size:"xl",disabled:(null===t||void 0===t?void 0:t.daysComplete)===(null===t||void 0===t?void 0:t.days)},(null===t||void 0===t?void 0:t.daysComplete)===(null===t||void 0===t?void 0:t.days)?"\u0426\u0435\u043b\u044c \u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u0430":"\u0412\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f"),mode:"tint",asideMode:!c&&"expand"})},F=function(e){var t=e.habits,a=Object(n.useContext)(R),o=Object(u.a)(a,2)[1];return t.map((function(e){return l.a.createElement(Y,{key:e._id,habit:e,dispatch:o})}))},q=(a(314),function(e){var t=e.id,a=e.habits,o=Object(n.useContext)(R),c=Object(u.a)(o,2),i=c[0],d=c[1],s=Object(n.useState)(!1),p=Object(u.a)(s,2),E=p[0],f=p[1];return l.a.createElement(b.a,{id:t},l.a.createElement(m.a,null,l.a.createElement(v.s,{aside:l.a.createElement(y.a,{style:{transform:"rotate(".concat(E?"180deg":"0",")")}}),onClick:function(){f(!E)}},"Habit")),l.a.createElement(v.t,{opened:E,onClose:function(){f(!E)}},l.a.createElement(v.m,null,l.a.createElement(v.f,null,l.a.createElement(v.j,{weight:"semibold"},"\u041e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438"),l.a.createElement(v.B,null,"Habit - \u0412\u0430\u0448 \u043b\u0438\u0447\u043d\u044b\u0439 \u043f\u043e\u043c\u043e\u0448\u043d\u0438\u043a \u0432 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u0440\u0438\u0432\u044b\u0447\u0435\u043a. \u041f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043f\u043e\u043c\u043e\u0433\u0430\u0435\u0442 \u0440\u0430\u0437\u0432\u0438\u0442\u044c \u0445\u043e\u0440\u043e\u0448\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 \u0438 \u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u043f\u043b\u043e\u0445\u0438\u0445.")),l.a.createElement(v.d,{before:l.a.createElement(S.a,null),onClick:function(){r.a.send("VKWebAppShare",{link:"https://vk.com/app7564973"})}},"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c"),i.allowNotifications?l.a.createElement(v.d,{before:l.a.createElement(C.a,null),onClick:function(){r.a.send("VKWebAppDenyNotifications")}},"\u041e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"):l.a.createElement(v.d,{before:l.a.createElement(A.a,null),onClick:function(){r.a.send("VKWebAppAllowNotifications")}},"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0443\u0432\u0435\u0434\u043e\u043c\u043b\u0435\u043d\u0438\u044f"))),0===a.length?l.a.createElement(v.u,{icon:l.a.createElement(_.a,null),action:l.a.createElement(v.c,{size:"l",mode:"tertiary",onClick:function(){d({type:"SET_MODAL",payload:{modal:"add-habit"}})}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0432\u0443\u044e \u0446\u0435\u043b\u044c"),stretched:!0},"\u0424\u043e\u0440\u043c\u0438\u0440\u0443\u0439\u0442\u0435 \u0441\u0432\u043e\u0438 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 \u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e. \u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043f\u0435\u0440\u0432\u0443\u044e \u0446\u0435\u043b\u044c \u0438 \u0441\u043b\u0435\u0434\u0443\u0439\u0442\u0435 \u043a \u043d\u0435\u0439"):l.a.createElement(v.i,{style:{paddingBottom:"60px"}},l.a.createElement(F,{habits:a})),0!==a.length&&l.a.createElement(v.g,{vertical:"bottom",className:"fixed-button"},l.a.createElement(v.h,null,l.a.createElement(v.d,{onClick:function(){d({type:"SET_MODAL",payload:{modal:"add-habit"}})},before:l.a.createElement(h.a,null)},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0446\u0435\u043b\u044c"))))}),J=a(50),X=a.n(J),Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=Object(n.useState)((function(){return localStorage.getItem(e)||t})),l=Object(u.a)(a,2),o=l[0],c=l[1],i=function(t){c(t),localStorage.setItem(e,t)};return[o,i]},Q=[{id:1,icon:l.a.createElement(X.a,null),header:"\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438",buttonText:"\u0414\u0430\u043b\u0435\u0435",placeholderText:"\u0412 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0438 \u0434\u0430\u0432\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0444\u0430\u043a\u0442, \u0447\u0442\u043e 21 \u0434\u043d\u044f \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 (\u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u0441\u0442\u0430\u0440\u044b\u0445) \u0438 \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0438"},{id:2,icon:l.a.createElement(X.a,null),header:"\u041f\u043e\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u0446\u0435\u043b\u044c \u0438 \u0438\u0434\u0438\u0442\u0435 \u043a \u043d\u0435\u0439",buttonText:"\u0414\u0430\u043b\u0435\u0435",placeholderText:"\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u0432 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0438 \u0446\u0435\u043b\u044c (\u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0443, \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u0445\u043e\u0442\u0438\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c) \u0438 \u043e\u0442\u043c\u0435\u0447\u0430\u0439\u0442\u0435 \u0435\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u0435 \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435"},{id:3,icon:l.a.createElement(X.a,null),header:"\u0412 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 \u0432\u0430\u0436\u043d\u0430 \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u043d\u043e\u0441\u0442\u044c",buttonText:"\u041d\u0430\u0447\u0430\u0442\u044c",placeholderText:"\u0412 \u0441\u043b\u0443\u0447\u0430\u0435 \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430 \u0435\u0436\u0435\u0434\u043d\u0435\u0432\u043d\u043e\u0439 \u043e\u0442\u043c\u0435\u0442\u043a\u0438 \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441 \u0441\u0431\u0440\u0430\u0441\u044b\u0432\u0430\u0435\u0442\u0441\u044f, \u043d\u043e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u0447\u0435\u0442\u0447\u0438\u043a \u0441\u043d\u0430\u0447\u0430\u043b\u0430"}],$={placeholder:{id:1,icon:l.a.createElement(X.a,null),header:"\u0424\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438",buttonText:"\u0414\u0430\u043b\u0435\u0435",placeholderText:"\u0412 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u0438 \u0434\u0430\u0432\u043d\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u0444\u0430\u043a\u0442, \u0447\u0442\u043e 21 \u0434\u043d\u044f \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0432\u044b\u0447\u043a\u0438 (\u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u043e\u0442 \u0441\u0442\u0430\u0440\u044b\u0445) \u0438 \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0436\u0438\u0437\u043d\u0438"}},ee=function(e,t){switch(t.type){case"SET_PLACEHOLDER":return Object(x.a)(Object(x.a)({},e),{},{placeholder:t.payload.placeholder});default:return e}},te=function(e){var t=e.id,a=Z("startup-done"),o=Object(u.a)(a,2)[1],c=Object(n.useReducer)(ee,$),i=Object(u.a)(c,2),r=i[0].placeholder,d=i[1],s=Object(n.useContext)(R),p=Object(u.a)(s,2)[1];return l.a.createElement(v.p,{id:t},l.a.createElement(v.q,null,"\u0412\u0432\u0435\u0434\u0435\u043d\u0438\u0435"),l.a.createElement(v.u,{icon:r.icon,header:r.header,action:[l.a.createElement(v.f,{key:"action"},l.a.createElement(v.c,{onClick:function(){r.id<3?d({type:"SET_PLACEHOLDER",payload:{placeholder:Q[r.id]}}):(p({type:"SET_VIEW",payload:{view:"home",panel:"home"}}),o("true"))}},r.buttonText)),l.a.createElement(v.f,{key:"skip"},3!==r.id&&l.a.createElement(v.c,{mode:"tertiary",onClick:function(){p({type:"SET_VIEW",payload:{view:"home",panel:"home"}}),o("true")}},"\u041f\u0440\u043e\u043f\u0443\u0441\u0442\u0438\u0442\u044c"))]},r.placeholderText))},ae=function(e){var t=e.id,a=Object(n.useContext)(R),o=Object(u.a)(a,2)[1],c=Z("startup-done"),i=Object(u.a)(c,1)[0];return Object(n.useEffect)((function(){if(i){var e=JSON.parse(i);o(e?{type:"SET_VIEW",payload:{view:"home",panel:"home"}}:{type:"SET_VIEW",payload:{view:"startup",panel:"startup"}})}else o({type:"SET_VIEW",payload:{view:"startup",panel:"startup"}})}),[o,i]),l.a.createElement(v.p,{id:t},l.a.createElement("div",null,"Habit"))},ne=a(141),le=a.n(ne),oe=a(142),ce=a.n(oe),ie=a(143),re=a.n(ie),ue=a(144),de=a.n(ue),se=a(145),pe=a.n(se),be=function(e){var t=e.habit,a=e.setHabit,o=Object(n.useContext)(R),c=Object(u.a)(o,2)[1],i=U("/habit/".concat(null===t||void 0===t?void 0:t._id)),d=Object(u.a)(i,2),s=d[0].response,p=d[1],b=Object(n.useState)(!1),E=Object(u.a)(b,2),m=E[0],f=E[1];Object(n.useEffect)((function(){m&&(p({method:"DELETE"}),f(!1))}),[m,p]),Object(n.useEffect)((function(){s&&(c({type:"SET_HABITS",payload:{habits:s}}),c({type:"SET_HISTORY_BACK"}))}),[s,c]);var h=(null===t||void 0===t?void 0:t.days)!==(null===t||void 0===t?void 0:t.daysComplete)?"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0434\u0443 \u043a \u0441\u0432\u043e\u0435\u0439 \u0446\u0435\u043b\u0438 ".concat(null===t||void 0===t?void 0:t.title,". \u0423\u0436\u0435 ").concat(null===t||void 0===t?void 0:t.daysComplete," \u0434\u043d\u0435\u0439 \u043f\u043e\u0434\u0440\u044f\u0434 \u0438\u0437 ").concat(null===t||void 0===t?void 0:t.days,". https://vk.com/app7564973"):"\u0423\u0441\u043f\u0435\u0448\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u043b \u043f\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0443\u044e \u0446\u0435\u043b\u044c ".concat(null===t||void 0===t?void 0:t.title,". https://vk.com/app7564973");return l.a.createElement(l.a.Fragment,null,l.a.createElement(v.q,{left:l.a.createElement(v.r,{onClick:function(){c({type:"SET_HISTORY_BACK"}),c({type:"SET_HABIT_ID",payload:{habitId:null}}),c({type:"SET_CHANGE_HABIT",payload:{habit:null}}),a(null)}})},null===t||void 0===t?void 0:t.title),l.a.createElement(Y,{habit:t,dispatch:c,isSingle:!0,setHabit:a}),l.a.createElement(v.m,null,l.a.createElement(v.d,{before:l.a.createElement(pe.a,null),onClick:function(){c({type:"SET_MODAL",payload:{modal:"add-habit"}})}},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"),l.a.createElement(v.d,{before:l.a.createElement(re.a,null),onClick:function(){r.a.send("VKWebAppShowWallPostBox",{message:h})}},(null===t||void 0===t?void 0:t.days)!==(null===t||void 0===t?void 0:t.daysComplete)?"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u043f\u0440\u043e\u0433\u0440\u0435\u0441\u0441\u043e\u043c":"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f \u0443\u0441\u043f\u0435\u0445\u043e\u043c"),l.a.createElement(v.d,{before:l.a.createElement(de.a,null),mode:"danger",onClick:function(){c({type:"SET_POPOUT",payload:{popout:l.a.createElement(v.a,{actionsLayout:"vertical",actions:[{title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",autoclose:!0,mode:"destructive",action:function(){return f(!0)}},{title:"\u041e\u0442\u043c\u0435\u043d\u0430",autoclose:!0,mode:"cancel"}],onClose:function(){c({type:"SET_POPOUT",payload:{popout:null}})}},l.a.createElement("h2",null,"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435"),l.a.createElement("p",null,"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c ",null===t||void 0===t?void 0:t.title,"?"),l.a.createElement("p",null,l.a.createElement("i",null,"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e!")))}})}},"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0446\u0435\u043b\u044c")))},Ee=a(146),me=a.n(Ee),ve=a(147),fe=a.n(ve),he=function(e){var t=e.children,a=Object(n.useContext)(R),o=Object(u.a)(a,2),c=o[0],i=o[1],r=Object(n.useState)(null),d=Object(u.a)(r,2),s=d[0],p=d[1];return Object(n.useEffect)((function(){c.error&&p(l.a.createElement(v.A,{onClose:function(){i({type:"SET_ERROR",payload:{error:null}}),p(null)},before:l.a.createElement(me.a,{style:{color:"var(--destructive)"}})},c.error.message))}),[p,i,c.error]),Object(n.useEffect)((function(){c.successMessage&&p(l.a.createElement(v.A,{onClose:function(){i({type:"SET_SUCCESS_MESSAGE",payload:{message:null}}),p(null)},before:l.a.createElement(fe.a,{style:{color:"var(--accent)"}})},c.successMessage))}),[p,i,c.successMessage]),l.a.createElement(l.a.Fragment,null,t,s)},Oe=function(){var e=new Date,t=e.getHours(),a=e.getMinutes(),n=t<10?"0".concat(t,":"):"".concat(t,":");return n+=a<10?"0".concat(a):a},ye=function(){var e=Object(n.useContext)(R),t=Object(u.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),i=Object(u.a)(c,2),d=i[0],p=i[1],b=Object(n.useState)(21),E=Object(u.a)(b,2),m=E[0],f=E[1],h=Object(n.useState)(!1),O=Object(u.a)(h,2),y=O[0],j=O[1],S=Object(n.useState)((function(){return Oe()})),T=Object(u.a)(S,2),_=T[0],w=T[1],C=Object(n.useState)("/habit"),g=Object(u.a)(C,2),A=g[0],I=g[1],x=U(A),k=Object(u.a)(x,2),N=k[0].response,H=k[1],P=Object(n.useState)(!0),W=Object(u.a)(P,2),M=W[0],D=W[1],L=Object(n.useState)(null),V=Object(u.a)(L,2),B=V[0],K=V[1];r.a.subscribe((function(e){var t=e.detail.type;"VKWebAppShareResult"!==t&&"VKWebAppShowWallPostBoxResult"!==t||o({type:"SET_SUCCESS_MESSAGE",payload:{message:"\u0417\u0430\u043f\u0438\u0441\u044c \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u0430"}}),"VKWebAppAllowNotificationsResult"===t&&o({type:"SET_ALLOW_NOTIFICATIONS"}),"VKWebAppDenyNotificationsResult"===t&&o({type:"SET_DENY_NOTIFICATIONS"})})),Object(n.useEffect)((function(){if(B){var e=Oe();p(null===B||void 0===B?void 0:B.title),f(null===B||void 0===B?void 0:B.days),j(!!(null===B||void 0===B?void 0:B.notification)),w((null===B||void 0===B?void 0:B.notification)||e)}else p(""),f(21),j(!1),w((function(){return Oe()}))}),[B]),Object(n.useEffect)((function(){M&&(H(),D(!1))}),[H,M]),Object(n.useEffect)((function(){N&&o({type:"SET_HABITS",payload:{habits:N}})}),[N,o]),Object(n.useEffect)((function(){a.habitId&&K(a.habits.find((function(e){return e._id===a.habitId})))}),[a.habitId,a.habits]);var G=function(){o({type:"SET_MODAL",payload:{modal:null}})};Object(n.useEffect)((function(){window.onpopstate=function(){"home"!==a.view&&"home"!==a.panel&&o({type:"SET_HISTORY_BACK"})}}),[o,a.panel,a.view]);var z=l.a.createElement(v.o,{activeModal:a.activeModal,onClose:G},l.a.createElement(v.n,{id:"add-habit",onClose:G,dynamicContentHeight:!0,header:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0446\u0435\u043b\u044c"},l.a.createElement(v.h,{id:"habit-add-form",onSubmit:function(e){e.preventDefault(),I(B?"/habit/".concat(null===B||void 0===B?void 0:B._id):"/habit"),H({method:B?"PATCH":"POST",title:d,days:m,time:y?_:null,timeZoneOffset:(new Date).getTimezoneOffset()}),o({type:"SET_MODAL",payload:{modal:null}}),B||(j(!1),f(21),p(""))}},l.a.createElement(v.l,{required:!0,type:"text",value:d,onChange:function(e){e.currentTarget.value.length<=20&&p(e.currentTarget.value)},top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0446\u0435\u043b\u0438",bottom:"\u0412\u0432\u0435\u0434\u0435\u043d\u043e: ".concat(d.length," \u0438\u0437 20")}),l.a.createElement(v.z,{min:1,max:21,step:1,value:m,top:"\u041a\u043e\u043b-\u0432\u043e \u0434\u043d\u0435\u0439: ".concat(m),onChange:function(e){f(e)}}),l.a.createElement(v.e,{type:"checkbox",checked:y,onChange:function(e){e.currentTarget.checked&&(a.allowNotifications||r.a.send("VKWebAppAllowNotifications")),j(e.currentTarget.checked)}},"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u043e\u043f\u043e\u0432\u0435\u0449\u0435\u043d\u0438\u044f"),l.a.createElement(v.l,{type:"time",value:_,disabled:!y,onChange:function(e){w(e.currentTarget.value)}}),l.a.createElement(v.c,{before:B?l.a.createElement(ce.a,null):l.a.createElement(le.a,null),size:"xl",style:{paddingBottom:0}},B?"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0446\u0435\u043b\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0446\u0435\u043b\u044c"))));return l.a.createElement(he,null,l.a.createElement(v.v,{alignY:"center",alignX:"center"},l.a.createElement(v.x,{activeView:a.view,popout:a.popout,modal:z},l.a.createElement(s.a,{activePanel:a.panel,id:"preloader"},l.a.createElement(ae,{id:"preloader"})),l.a.createElement(s.a,{activePanel:a.panel,id:"startup"},l.a.createElement(te,{id:"startup"})),l.a.createElement(s.a,{activePanel:a.panel,id:"habit-page"},l.a.createElement(v.p,{id:"habit-page"},l.a.createElement(be,{habit:B,setHabit:K}))),l.a.createElement(s.a,{activePanel:a.panel,id:"home"},l.a.createElement(q,{id:"home",habits:a.habits})))))};r.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var l=document.createAttribute("scheme");l.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(l)}})),r.a.send("VKWebAppInit"),c.a.render(l.a.createElement(W,null,l.a.createElement(ye,null)),document.getElementById("root"))}},[[195,1,2]]]);
//# sourceMappingURL=main.464be515.chunk.js.map